# ãƒ†ã‚¹ãƒˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã¨ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã€ãƒ†ã‚¹ãƒˆå®Ÿè£…æ™‚ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã€ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ã€ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã€ã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚

## ğŸ“‹ ç›®æ¬¡

- [ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™](#ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™)
- [ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹](#ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹)
  - [ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ãƒ»ã‚¹ãƒˆãƒªãƒ³ã‚°ã®æ’é™¤](#ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã‚¹ãƒˆãƒªãƒ³ã‚°ã®æ’é™¤)
  - [FixtureåŒ–ã¨ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼é–¢æ•°](#fixtureåŒ–ã¨ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼é–¢æ•°)
- [ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](#ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹)
- [å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](#å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ)
- [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

## ğŸ¯ ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™

### ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ¥ã®æ¨å¥¨ã‚«ãƒãƒ¬ãƒƒã‚¸

```
ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤:     100%  ï¼ˆå¿…é ˆï¼‰
ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°:     100%  ï¼ˆå¿…é ˆï¼‰
ã‚µãƒ¼ãƒ“ã‚¹å±¤:            90%ä»¥ä¸Šï¼ˆæ¨å¥¨ï¼‰
ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å±¤:      80%ä»¥ä¸Šï¼ˆæ¨å¥¨ï¼‰
UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå±¤:    70%ä»¥ä¸Šï¼ˆæ¨å¥¨ï¼‰
çµ±åˆãƒ†ã‚¹ãƒˆ:            ä¸»è¦ãƒ•ãƒ­ãƒ¼ï¼ˆå¿…é ˆï¼‰
E2Eãƒ†ã‚¹ãƒˆ:            ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ‘ã‚¹ï¼ˆå¿…é ˆï¼‰
```

### ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¡ãƒˆãƒªã‚¯ã‚¹

**æ¸¬å®šã™ã‚‹æŒ‡æ¨™:**
1. **è¡Œã‚«ãƒãƒ¬ãƒƒã‚¸ï¼ˆLine Coverageï¼‰**
   - å®Ÿè¡Œã•ã‚ŒãŸè¡Œã®å‰²åˆ
   - æœ€ã‚‚åŸºæœ¬çš„ãªæŒ‡æ¨™

2. **åˆ†å²ã‚«ãƒãƒ¬ãƒƒã‚¸ï¼ˆBranch Coverageï¼‰**
   - if/elseãªã©ã€ã™ã¹ã¦ã®åˆ†å²ã‚’å®Ÿè¡Œã—ãŸã‹
   - è«–ç†çš„ãªç¶²ç¾…æ€§ã‚’ç¢ºèª

3. **é–¢æ•°ã‚«ãƒãƒ¬ãƒƒã‚¸ï¼ˆFunction Coverageï¼‰**
   - å‘¼ã³å‡ºã•ã‚ŒãŸé–¢æ•°ã®å‰²åˆ
   - æœªä½¿ç”¨ã‚³ãƒ¼ãƒ‰ã®æ¤œå‡º

4. **ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ï¼ˆStatement Coverageï¼‰**
   - å®Ÿè¡Œã•ã‚ŒãŸã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®å‰²åˆ
   - è¡Œã‚«ãƒãƒ¬ãƒƒã‚¸ã‚ˆã‚Šç²¾å¯†

### ã‚«ãƒãƒ¬ãƒƒã‚¸ç¢ºèªã‚³ãƒãƒ³ãƒ‰

```bash
# Jest ã§ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
npm test -- --coverage

# Vitest ã§ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
npm run test:coverage

# ã‚«ãƒãƒ¬ãƒƒã‚¸é–¾å€¤ã®è¨­å®šï¼ˆpackage.json ã¾ãŸã¯ jest.config.jsï¼‰
{
  "jest": {
    "coverageThreshold": {
      "global": {
        "branches": 80,
        "functions": 80,
        "lines": 80,
        "statements": 80
      }
    }
  }
}
```

### ã‚«ãƒãƒ¬ãƒƒã‚¸ã®å„ªå…ˆé †ä½

**é«˜å„ªå…ˆåº¦ï¼ˆ100%å¿…é ˆï¼‰:**
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é–¢æ•°
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é–¢é€£ã‚³ãƒ¼ãƒ‰
- é‡‘é¡è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
- ãƒ‡ãƒ¼ã‚¿å¤‰æ›é–¢æ•°

**ä¸­å„ªå…ˆåº¦ï¼ˆ80%ä»¥ä¸Šæ¨å¥¨ï¼‰:**
- API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- ã‚µãƒ¼ãƒ“ã‚¹å±¤
- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼
- ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢

**ä½å„ªå…ˆåº¦ï¼ˆåŠªåŠ›ç›®æ¨™ï¼‰:**
- UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆãƒ­ã‚¸ãƒƒã‚¯å°‘ãªã„å ´åˆï¼‰
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
- å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«

## âœ… ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ãƒ†ã‚¹ãƒˆæ§‹é€ ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

#### 1. AAA ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å¾¹åº•

```typescript
it('should calculate total with discount', () => {
  // Arrangeï¼ˆæº–å‚™ï¼‰
  const items = [100, 200, 300]
  const discountRate = 0.1

  // Actï¼ˆå®Ÿè¡Œï¼‰
  const result = calculateTotal(items, discountRate)

  // Assertï¼ˆæ¤œè¨¼ï¼‰
  expect(result).toBe(540)
})
```

#### 2. ãƒ†ã‚¹ãƒˆåã¯ä»•æ§˜ã‚’èª¬æ˜

```typescript
// âŒ æ‚ªã„ä¾‹
it('test 1', () => { ... })
it('user test', () => { ... })

// âœ… è‰¯ã„ä¾‹
it('should throw error when email is invalid', () => { ... })
it('should return null when user not found', () => { ... })
it('should calculate discount correctly for multiple items', () => { ... })
```

#### 3. 1ãƒ†ã‚¹ãƒˆ1ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆåŸå‰‡ï¼‰

```typescript
// âŒ æ‚ªã„ä¾‹: è¤‡æ•°ã®ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³
it('should create user', () => {
  const user = createUser(userData)
  expect(user.id).toBeDefined()
  expect(user.name).toBe('John')
  expect(user.email).toBe('john@example.com')
  expect(user.createdAt).toBeInstanceOf(Date)
})

// âœ… è‰¯ã„ä¾‹: åˆ†å‰²
describe('createUser', () => {
  it('should generate user id', () => {
    const user = createUser(userData)
    expect(user.id).toBeDefined()
  })

  it('should set user name from input', () => {
    const user = createUser({ ...userData, name: 'John' })
    expect(user.name).toBe('John')
  })

  it('should set user email from input', () => {
    const user = createUser({ ...userData, email: 'john@example.com' })
    expect(user.email).toBe('john@example.com')
  })
})
```

#### 4. ãƒ†ã‚¹ãƒˆã®ç‹¬ç«‹æ€§

```typescript
// âŒ æ‚ªã„ä¾‹: å‰ã®ãƒ†ã‚¹ãƒˆã«ä¾å­˜
let user: User

it('should create user', () => {
  user = createUser(userData) // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«ä¿å­˜
})

it('should update user', () => {
  updateUser(user.id, { name: 'Jane' }) // å‰ã®ãƒ†ã‚¹ãƒˆã«ä¾å­˜
})

// âœ… è‰¯ã„ä¾‹: å„ãƒ†ã‚¹ãƒˆãŒç‹¬ç«‹
describe('User operations', () => {
  it('should create user', () => {
    const user = createUser(userData)
    expect(user.id).toBeDefined()
  })

  it('should update user', () => {
    const user = createUser(userData) // ç‹¬ç«‹ã—ã¦æº–å‚™
    const updated = updateUser(user.id, { name: 'Jane' })
    expect(updated.name).toBe('Jane')
  })
})
```

### ãƒ¢ãƒƒã‚¯ãƒ»ã‚¹ã‚¿ãƒ–ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

#### 1. å¿…è¦æœ€å°é™ã®ãƒ¢ãƒƒã‚¯

```typescript
// âŒ æ‚ªã„ä¾‹: éåº¦ãªãƒ¢ãƒƒã‚¯
const mockUser = {
  id: '1',
  name: 'John',
  email: 'john@example.com',
  address: { /* ... */ },
  preferences: { /* ... */ },
  // ä¸è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¾ã§ãƒ¢ãƒƒã‚¯
}

// âœ… è‰¯ã„ä¾‹: å¿…è¦ãªéƒ¨åˆ†ã®ã¿
const mockUser = {
  id: '1',
  name: 'John'
}
```

#### 2. ãƒ¢ãƒƒã‚¯ã®å†åˆ©ç”¨

```typescript
// âœ… è‰¯ã„ä¾‹: ãƒ†ã‚¹ãƒˆãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’ä½œæˆ
function createMockUser(overrides?: Partial<User>): User {
  return {
    id: '1',
    name: 'John Doe',
    email: 'john@example.com',
    ...overrides
  }
}

// ä½¿ç”¨ä¾‹
it('should process user', () => {
  const user = createMockUser({ name: 'Jane' })
  // ...
})
```

#### 3. ã‚¹ãƒ‘ã‚¤ã®æ´»ç”¨

```typescript
// âœ… è‰¯ã„ä¾‹: å®Ÿè£…ã‚’å‘¼ã³ã¤ã¤ã€å‘¼ã³å‡ºã—ã‚’è¨˜éŒ²
const logger = {
  info: jest.fn(), // ã‚¹ãƒ‘ã‚¤
  error: jest.fn()
}

const service = new UserService(db, logger)
await service.createUser(userData)

expect(logger.info).toHaveBeenCalledWith(
  expect.stringContaining('User created')
)
```

### ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ãƒ»ã‚¹ãƒˆãƒªãƒ³ã‚°ã®æ’é™¤

#### å•é¡Œ
ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ï¼ˆ`100`, `0.1`ï¼‰ã‚„ãƒã‚¸ãƒƒã‚¯ã‚¹ãƒˆãƒªãƒ³ã‚°ï¼ˆ`"ACTIVE"`, `"admin"`ï¼‰ã‚’ç›´æ›¸ãã™ã‚‹ã¨ã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚ã®ä¿®æ­£æ¼ã‚Œã‚„ã‚³ãƒ¼ãƒ‰ã®æ„å›³ä¸æ˜ç­åŒ–ã‚’å¼•ãèµ·ã“ã—ã¾ã™ã€‚

#### å¯¾ç­–: Enumãƒ»å®šæ•°ã®ä½¿ç”¨

##### Enumã®ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰

```typescript
// âŒ æ‚ªã„ä¾‹: ãƒã‚¸ãƒƒã‚¯ã‚¹ãƒˆãƒªãƒ³ã‚°ç›´æ›¸ã
describe('UserService', () => {
  it('should create active user', async () => {
    const user = await service.create({ name: 'John', status: 'ACTIVE' })
    expect(user.status).toBe('ACTIVE')
  })

  it('should update to inactive', async () => {
    await service.updateStatus('user1', 'INACTIVE')
    const user = await service.findById('user1')
    expect(user.status).toBe('INACTIVE')
  })
})

// âœ… è‰¯ã„ä¾‹: Enumã‚’ä½¿ç”¨
import { UserStatus } from '@/types/user'

describe('UserService', () => {
  it('should create active user', async () => {
    const user = await service.create({ name: 'John', status: UserStatus.Active })
    expect(user.status).toBe(UserStatus.Active)
  })

  it('should update to inactive', async () => {
    await service.updateStatus('user1', UserStatus.Inactive)
    const user = await service.findById('user1')
    expect(user.status).toBe(UserStatus.Inactive)
  })
})
```

##### å®šæ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½¿ç”¨

```typescript
// âŒ æ‚ªã„ä¾‹: ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ç›´æ›¸ã
describe('PricingService', () => {
  it('should apply standard discount', () => {
    expect(calculateDiscount(1000, 'STANDARD')).toBe(900) // 0.1ã®ç›´æ›¸ã
  })

  it('should apply premium discount', () => {
    expect(calculateDiscount(1000, 'PREMIUM')).toBe(800) // 0.2ã®ç›´æ›¸ã
  })

  it('should apply free shipping threshold', () => {
    expect(calculateShippingFee(5000)).toBe(0) // 3000å††ã®é–¾å€¤ãŒä¸æ˜
  })
})

// âœ… è‰¯ã„ä¾‹: å®šæ•°ã‚’ä½¿ç”¨
const DISCOUNT_RATES = {
  STANDARD: 0.1,
  PREMIUM: 0.2,
} as const

const SHIPPING = {
  FREE_THRESHOLD: 3000,
  STANDARD_FEE: 500,
} as const

describe('PricingService', () => {
  it('should apply standard discount', () => {
    const amount = 1000
    const expected = amount * (1 - DISCOUNT_RATES.STANDARD)
    expect(calculateDiscount(amount, 'STANDARD')).toBe(expected)
  })

  it('should apply premium discount', () => {
    const amount = 1000
    const expected = amount * (1 - DISCOUNT_RATES.PREMIUM)
    expect(calculateDiscount(amount, 'PREMIUM')).toBe(expected)
  })

  it('should apply free shipping for orders over threshold', () => {
    expect(calculateShippingFee(SHIPPING.FREE_THRESHOLD)).toBe(0)
  })

  it('should charge standard fee for orders under threshold', () => {
    expect(calculateShippingFee(SHIPPING.FREE_THRESHOLD - 1)).toBe(SHIPPING.STANDARD_FEE)
  })
})
```

##### ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã®å®šæ•°ã‚’å†åˆ©ç”¨

```typescript
// src/constants/pricing.ts
export const DISCOUNT_RATES = {
  STANDARD: 0.1,
  PREMIUM: 0.2,
  VIP: 0.3,
} as const

export const SHIPPING = {
  FREE_THRESHOLD: 3000,
  STANDARD_FEE: 500,
  EXPRESS_FEE: 1000,
} as const

// src/services/pricing.test.ts
import { DISCOUNT_RATES, SHIPPING } from '@/constants/pricing'

describe('PricingService', () => {
  it('should apply standard discount', () => {
    const amount = 1000
    const expected = amount * (1 - DISCOUNT_RATES.STANDARD)
    expect(calculateDiscount(amount, 'STANDARD')).toBe(expected)
  })

  it('should charge standard shipping fee', () => {
    const amount = SHIPPING.FREE_THRESHOLD - 1
    expect(calculateShippingFee(amount)).toBe(SHIPPING.STANDARD_FEE)
  })
})
```

#### ãƒ¡ãƒªãƒƒãƒˆ

1. **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®‰å…¨æ€§**: å€¤ã®å¤‰æ›´ãŒ1ç®‡æ‰€ã§å®Œçµ
2. **æ„å›³ã®æ˜ç¤º**: `SHIPPING.FREE_THRESHOLD` ã¯ `3000` ã‚ˆã‚Šæ„å›³ãŒæ˜ç¢º
3. **å‹å®‰å…¨æ€§**: TypeScriptã®å‹æ¨è«–ãŒåŠ¹ã
4. **IDEè£œå®Œ**: Enumã‚„å®šæ•°ã¯IDEã§è£œå®Œã•ã‚Œã‚‹

---

### FixtureåŒ–ã¨ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼é–¢æ•°

#### å•é¡Œ
å„ãƒ†ã‚¹ãƒˆã§ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’æ¯å›æ§‹ç¯‰ã™ã‚‹ã¨ã€ã‚³ãƒ¼ãƒ‰é‡è¤‡ãƒ»å‹å¤‰æ›´æ™‚ã®ä¿®æ­£æ¼ã‚Œãƒ»å¯èª­æ€§ä½ä¸‹ãŒç™ºç”Ÿã—ã¾ã™ã€‚

#### å¯¾ç­–: ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼é–¢æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³

##### åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³

```typescript
// âŒ æ‚ªã„ä¾‹: å„ãƒ†ã‚¹ãƒˆã§ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’é‡è¤‡ç”Ÿæˆ
describe('UserService', () => {
  it('should create user', async () => {
    const userData = {
      id: '1',
      email: 'john@example.com',
      name: 'John Doe',
      role: 'USER',
      status: 'ACTIVE',
      createdAt: new Date(),
      updatedAt: new Date(),
    }
    const user = await service.create(userData)
    expect(user.id).toBe('1')
  })

  it('should update user', async () => {
    const userData = {
      id: '1',
      email: 'john@example.com',
      name: 'John Doe',
      role: 'USER',
      status: 'ACTIVE',
      createdAt: new Date(),
      updatedAt: new Date(),
    }
    const updated = await service.update('1', { name: 'Jane Doe' })
    expect(updated.name).toBe('Jane Doe')
  })

  it('should delete user', async () => {
    const userData = {
      id: '1',
      email: 'john@example.com',
      name: 'John Doe',
      role: 'USER',
      status: 'ACTIVE',
      createdAt: new Date(),
      updatedAt: new Date(),
    }
    await service.delete('1')
    const user = await service.findById('1')
    expect(user).toBeNull()
  })
})

// âœ… è‰¯ã„ä¾‹: ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼é–¢æ•°ã§å…±é€šåŒ–
import { UserRole, UserStatus } from '@/types/user'

function createUserFixture(overrides?: Partial<User>): User {
  return {
    id: '1',
    email: 'john@example.com',
    name: 'John Doe',
    role: UserRole.User,
    status: UserStatus.Active,
    createdAt: new Date('2024-01-01'),
    updatedAt: new Date('2024-01-01'),
    ...overrides,
  }
}

describe('UserService', () => {
  it('should create user', async () => {
    const userData = createUserFixture()
    const user = await service.create(userData)
    expect(user.id).toBe('1')
  })

  it('should update user', async () => {
    const userData = createUserFixture()
    const updated = await service.update('1', { name: 'Jane Doe' })
    expect(updated.name).toBe('Jane Doe')
  })

  it('should delete user', async () => {
    const userData = createUserFixture()
    await service.delete('1')
    const user = await service.findById('1')
    expect(user).toBeNull()
  })

  it('should handle admin role', async () => {
    const adminUser = createUserFixture({ role: UserRole.Admin })
    const user = await service.create(adminUser)
    expect(user.role).toBe(UserRole.Admin)
  })

  it('should handle inactive status', async () => {
    const inactiveUser = createUserFixture({ status: UserStatus.Inactive })
    const user = await service.create(inactiveUser)
    expect(user.status).toBe(UserStatus.Inactive)
  })
})
```

##### ãƒã‚¹ãƒˆã—ãŸã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®Fixture

```typescript
// âŒ æ‚ªã„ä¾‹: ãƒã‚¹ãƒˆã—ãŸæ§‹é€ ã‚’æ¯å›æ§‹ç¯‰
describe('OrderService', () => {
  it('should create order with customer', async () => {
    const orderData = {
      id: 'order1',
      items: [
        { id: 'item1', name: 'Product A', price: 1000, quantity: 2 },
        { id: 'item2', name: 'Product B', price: 2000, quantity: 1 },
      ],
      customer: {
        id: 'customer1',
        name: 'John Doe',
        email: 'john@example.com',
        address: {
          street: '123 Main St',
          city: 'Tokyo',
          postalCode: '100-0001',
          country: 'Japan',
        },
      },
      createdAt: new Date(),
    }
    const order = await service.create(orderData)
    expect(order.id).toBe('order1')
  })
})

// âœ… è‰¯ã„ä¾‹: éšå±¤çš„ãªãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼é–¢æ•°
function createAddressFixture(overrides?: Partial<Address>): Address {
  return {
    street: '123 Main St',
    city: 'Tokyo',
    postalCode: '100-0001',
    country: 'Japan',
    ...overrides,
  }
}

function createCustomerFixture(
  overrides?: Partial<Customer>,
  addressOverrides?: Partial<Address>
): Customer {
  return {
    id: 'customer1',
    name: 'John Doe',
    email: 'john@example.com',
    address: createAddressFixture(addressOverrides),
    ...overrides,
  }
}

function createOrderItemFixture(overrides?: Partial<OrderItem>): OrderItem {
  return {
    id: 'item1',
    name: 'Product A',
    price: 1000,
    quantity: 1,
    ...overrides,
  }
}

function createOrderFixture(
  overrides?: Partial<Order>,
  customerOverrides?: Partial<Customer>
): Order {
  return {
    id: 'order1',
    items: [createOrderItemFixture()],
    customer: createCustomerFixture(customerOverrides),
    createdAt: new Date('2024-01-01'),
    ...overrides,
  }
}

describe('OrderService', () => {
  it('should create order with customer', async () => {
    const orderData = createOrderFixture()
    const order = await service.create(orderData)
    expect(order.id).toBe('order1')
  })

  it('should create order with custom address', async () => {
    const orderData = createOrderFixture(
      {},
      { address: createAddressFixture({ city: 'Osaka' }) }
    )
    const order = await service.create(orderData)
    expect(order.customer.address.city).toBe('Osaka')
  })

  it('should create order with multiple items', async () => {
    const orderData = createOrderFixture({
      items: [
        createOrderItemFixture({ name: 'Product A', price: 1000 }),
        createOrderItemFixture({ id: 'item2', name: 'Product B', price: 2000 }),
      ],
    })
    const order = await service.create(orderData)
    expect(order.items).toHaveLength(2)
  })
})
```

##### ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æŒã¤ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®Fixture

```typescript
// âœ… è‰¯ã„ä¾‹: ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼é–¢æ•°
function createOrganizationFixture(overrides?: Partial<Organization>): Organization {
  return {
    id: 'org1',
    name: 'ACME Corp',
    status: OrganizationStatus.Active,
    createdAt: new Date('2024-01-01'),
    updatedAt: new Date('2024-01-01'),
    ...overrides,
  }
}

function createProjectFixture(
  overrides?: Partial<Project>,
  organization?: Organization
): Project {
  return {
    id: 'proj1',
    name: 'Project Alpha',
    organizationId: organization?.id ?? 'org1',
    organization: organization ?? createOrganizationFixture(),
    status: ProjectStatus.Active,
    createdAt: new Date('2024-01-01'),
    updatedAt: new Date('2024-01-01'),
    ...overrides,
  }
}

function createTaskFixture(
  overrides?: Partial<Task>,
  project?: Project
): Task {
  return {
    id: 'task1',
    title: 'Implement feature',
    projectId: project?.id ?? 'proj1',
    project: project ?? createProjectFixture(),
    status: TaskStatus.Todo,
    createdAt: new Date('2024-01-01'),
    ...overrides,
  }
}

describe('TaskService', () => {
  it('should create task with project and organization', async () => {
    const org = createOrganizationFixture({ name: 'Custom Org' })
    const project = createProjectFixture({ name: 'Custom Project' }, org)
    const task = createTaskFixture({ title: 'Custom Task' }, project)

    const saved = await service.create(task)
    expect(saved.project.organization.name).toBe('Custom Org')
  })

  it('should filter tasks by organization', async () => {
    const org1 = createOrganizationFixture({ id: 'org1' })
    const org2 = createOrganizationFixture({ id: 'org2' })

    const project1 = createProjectFixture({ id: 'proj1' }, org1)
    const project2 = createProjectFixture({ id: 'proj2' }, org2)

    await service.create(createTaskFixture({}, project1))
    await service.create(createTaskFixture({}, project2))

    const tasks = await service.findByOrganization('org1')
    expect(tasks).toHaveLength(1)
    expect(tasks[0].project.organizationId).toBe('org1')
  })
})
```

##### Fixtureãƒ•ã‚¡ã‚¤ãƒ«ã®é…ç½®ã¨å†åˆ©ç”¨

```typescript
// src/test/fixtures/user.fixture.ts
import { User, UserRole, UserStatus } from '@/types/user'

export function createUserFixture(overrides?: Partial<User>): User {
  return {
    id: '1',
    email: 'john@example.com',
    name: 'John Doe',
    role: UserRole.User,
    status: UserStatus.Active,
    createdAt: new Date('2024-01-01'),
    updatedAt: new Date('2024-01-01'),
    ...overrides,
  }
}

export function createAdminUserFixture(overrides?: Partial<User>): User {
  return createUserFixture({
    role: UserRole.Admin,
    ...overrides,
  })
}

// src/test/fixtures/index.tsï¼ˆã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆé›†ç´„ï¼‰
export * from './user.fixture'
export * from './organization.fixture'
export * from './project.fixture'

// src/services/user.test.ts
import { createUserFixture, createAdminUserFixture } from '@/test/fixtures'

describe('UserService', () => {
  it('should create regular user', async () => {
    const user = createUserFixture({ email: 'test@example.com' })
    const saved = await service.create(user)
    expect(saved.role).toBe(UserRole.User)
  })

  it('should create admin user', async () => {
    const admin = createAdminUserFixture({ email: 'admin@example.com' })
    const saved = await service.create(admin)
    expect(saved.role).toBe(UserRole.Admin)
  })
})
```

##### ãƒ“ãƒ«ãƒ€ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆè¤‡é›‘ãªã‚±ãƒ¼ã‚¹ï¼‰

```typescript
// âœ… è‰¯ã„ä¾‹: ãƒ“ãƒ«ãƒ€ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆè¤‡é›‘ãªæ§‹ç¯‰ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
class UserFixtureBuilder {
  private user: Partial<User> = {
    id: '1',
    email: 'john@example.com',
    name: 'John Doe',
    role: UserRole.User,
    status: UserStatus.Active,
    createdAt: new Date('2024-01-01'),
    updatedAt: new Date('2024-01-01'),
  }

  withEmail(email: string): this {
    this.user.email = email
    return this
  }

  withRole(role: UserRole): this {
    this.user.role = role
    return this
  }

  withStatus(status: UserStatus): this {
    this.user.status = status
    return this
  }

  asAdmin(): this {
    this.user.role = UserRole.Admin
    return this
  }

  asInactive(): this {
    this.user.status = UserStatus.Inactive
    return this
  }

  build(): User {
    return this.user as User
  }
}

describe('UserService', () => {
  it('should create admin user', async () => {
    const admin = new UserFixtureBuilder()
      .withEmail('admin@example.com')
      .asAdmin()
      .build()

    const saved = await service.create(admin)
    expect(saved.role).toBe(UserRole.Admin)
  })

  it('should create inactive user', async () => {
    const inactive = new UserFixtureBuilder()
      .withEmail('inactive@example.com')
      .asInactive()
      .build()

    const saved = await service.create(inactive)
    expect(saved.status).toBe(UserStatus.Inactive)
  })
})
```

#### ãƒ¡ãƒªãƒƒãƒˆ

1. **DRYåŸå‰‡**: é‡è¤‡ã‚³ãƒ¼ãƒ‰å‰Šæ¸›
2. **å‹å®‰å…¨æ€§**: å‹å¤‰æ›´æ™‚ã®ä¿®æ­£æ¼ã‚Œé˜²æ­¢
3. **å¯èª­æ€§**: `createUserFixture({ role: UserRole.Admin })` ã§æ„å›³ãŒæ˜ç¢º
4. **ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§**: ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›´ãŒ1ç®‡æ‰€ã§å®Œçµ
5. **ãƒ†ã‚¹ãƒˆã®æ„å›³æ˜ç¤º**: å¿…è¦ãªå±æ€§ã®ã¿ä¸Šæ›¸ãã™ã‚‹ã“ã¨ã§ã€ãƒ†ã‚¹ãƒˆã®ç„¦ç‚¹ãŒæ˜ç¢ºã«ãªã‚‹

---

### éåŒæœŸãƒ†ã‚¹ãƒˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

#### 1. async/await ã®ä½¿ç”¨

```typescript
// âŒ æ‚ªã„ä¾‹: ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯åœ°ç„
it('should fetch user', (done) => {
  fetchUser('1').then((user) => {
    expect(user.name).toBe('John')
    done()
  })
})

// âœ… è‰¯ã„ä¾‹: async/await
it('should fetch user', async () => {
  const user = await fetchUser('1')
  expect(user.name).toBe('John')
})
```

#### 2. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```typescript
// âœ… è‰¯ã„ä¾‹: ã‚¨ãƒ©ãƒ¼ã®ãƒ†ã‚¹ãƒˆ
it('should throw error for invalid id', async () => {
  await expect(fetchUser('invalid')).rejects.toThrow('Invalid ID')
})

// ã¾ãŸã¯
it('should throw error for invalid id', async () => {
  try {
    await fetchUser('invalid')
    fail('Should have thrown error')
  } catch (error) {
    expect(error.message).toBe('Invalid ID')
  }
})
```

#### 3. ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã®è¨­å®š

```typescript
// âœ… è‰¯ã„ä¾‹: ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
it('should complete within 5 seconds', async () => {
  const start = Date.now()
  await longRunningOperation()
  const duration = Date.now() - start

  expect(duration).toBeLessThan(5000)
}, 10000) // ãƒ†ã‚¹ãƒˆå…¨ä½“ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: 10ç§’
```

## ğŸ› ï¸ ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### Jest ã‚³ãƒãƒ³ãƒ‰

```bash
# ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
npm test

# ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å®Ÿè¡Œ
npm test user.test.ts

# ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm test -- --testPathPattern=user

# watch ãƒ¢ãƒ¼ãƒ‰ï¼ˆå¤‰æ›´ã‚’ç›£è¦–ï¼‰
npm test -- --watch

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
npm test -- --coverage

# å¤±æ•—ã—ãŸãƒ†ã‚¹ãƒˆã®ã¿å†å®Ÿè¡Œ
npm test -- --onlyFailures

# è©³ç´°ãªå‡ºåŠ›
npm test -- --verbose

# ä¸¦åˆ—å®Ÿè¡Œã®åˆ¶å¾¡
npm test -- --maxWorkers=4

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã®ã¿
npm test -- --testNamePattern="should create user"
```

### Vitest ã‚³ãƒãƒ³ãƒ‰

```bash
# ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
npm run test

# watch ãƒ¢ãƒ¼ãƒ‰
npm run test:watch

# UI ãƒ¢ãƒ¼ãƒ‰
npm run test:ui

# ã‚«ãƒãƒ¬ãƒƒã‚¸
npm run test:coverage

# ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«
npm run test user.test.ts

# ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
npm run test -- --grep="user"
```

### Playwright ã‚³ãƒãƒ³ãƒ‰

```bash
# ã™ã¹ã¦ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
npx playwright test

# ç‰¹å®šã®ãƒ–ãƒ©ã‚¦ã‚¶ã§å®Ÿè¡Œ
npx playwright test --project=chromium

# ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ãƒ¢ãƒ¼ãƒ‰ã‚’ç„¡åŠ¹åŒ–ï¼ˆãƒ‡ãƒãƒƒã‚°ï¼‰
npx playwright test --headed

# UI ãƒ¢ãƒ¼ãƒ‰
npx playwright test --ui

# ãƒ‡ãƒãƒƒã‚°ãƒ¢ãƒ¼ãƒ‰
npx playwright test --debug

# ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º
npx playwright show-report

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
npx playwright test login.spec.ts

# ä¸¦åˆ—å®Ÿè¡Œæ•°ã®åˆ¶å¾¡
npx playwright test --workers=4
```

### ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è¨­å®šä¾‹ï¼ˆpackage.jsonï¼‰

```json
{
  "scripts": {
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "test:unit": "jest --testPathPattern=unit",
    "test:integration": "jest --testPathPattern=integration",
    "test:e2e": "playwright test",
    "test:e2e:ui": "playwright test --ui",
    "test:all": "npm run test:unit && npm run test:integration && npm run test:e2e"
  }
}
```

## ğŸ“ å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆå®Ÿè£…å‰ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] è¦ä»¶ã‚’ç†è§£ã—ã¦ã„ã‚‹ã‹
- [ ] ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ã‚³ãƒ¼ãƒ‰ã¯å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹ï¼ˆTDDã®å ´åˆã¯ä¸è¦ï¼‰
- [ ] ãƒ†ã‚¹ãƒˆå¯èƒ½ãªè¨­è¨ˆã«ãªã£ã¦ã„ã‚‹ã‹ï¼ˆä¾å­˜æ€§æ³¨å…¥ç­‰ï¼‰
- [ ] ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ã¯å®Œäº†ã—ã¦ã„ã‚‹ã‹

### ãƒ†ã‚¹ãƒˆä½œæˆæ™‚ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å‘½åè¦å‰‡ã«å¾“ã£ã¦ã„ã‚‹ã‹ï¼ˆ`*.test.ts` ã¾ãŸã¯ `*.spec.ts`ï¼‰
- [ ] AAA ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¾“ã£ã¦ã„ã‚‹ã‹
- [ ] ãƒ†ã‚¹ãƒˆåã¯ä»•æ§˜ã‚’èª¬æ˜ã—ã¦ã„ã‚‹ã‹
- [ ] æ­£å¸¸ç³»ã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ãŸã‹
- [ ] ç•°å¸¸ç³»ã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ãŸã‹
- [ ] ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã‚’è€ƒæ…®ã—ãŸã‹
- [ ] ãƒ¢ãƒƒã‚¯/ã‚¹ã‚¿ãƒ–ã¯é©åˆ‡ã«ä½¿ç”¨ã—ã¦ã„ã‚‹ã‹
- [ ] ãƒ†ã‚¹ãƒˆã¯ç‹¬ç«‹ã—ã¦ã„ã‚‹ã‹ï¼ˆé †åºã«ä¾å­˜ã—ãªã„ï¼‰

### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ã¦ã„ã‚‹ã‹
- [ ] ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ã‚’é”æˆã—ã¦ã„ã‚‹ã‹
- [ ] è­¦å‘Šã‚„ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ãªã„ã‹
- [ ] ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“ã¯è¨±å®¹ç¯„å›²å†…ã‹ï¼ˆå˜ä½“ãƒ†ã‚¹ãƒˆã¯é«˜é€Ÿï¼‰
- [ ] CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ã‚‚ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã™ã‚‹ã‹

### ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®å¯èª­æ€§ã¯é«˜ã„ã‹
- [ ] é‡è¤‡ã—ãŸãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã¯ãªã„ã‹
- [ ] ãƒ†ã‚¹ãƒˆãƒ˜ãƒ«ãƒ‘ãƒ¼ã¯é©åˆ‡ã«æ´»ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã¯å®šæ•°åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ï¼ˆEnum/å®šæ•°ä½¿ç”¨ï¼‰
- [ ] ãƒã‚¸ãƒƒã‚¯ã‚¹ãƒˆãƒªãƒ³ã‚°ã¯å®šæ•°åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ï¼ˆ`"ACTIVE"` â†’ `Status.Active`ï¼‰
- [ ] Fixture/ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼é–¢æ•°ãŒæ´»ç”¨ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] å„ãƒ†ã‚¹ãƒˆã«ã€Œä»•æ§˜ã‚³ãƒ¡ãƒ³ãƒˆã€ãŒè¨˜è¿°ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®è²¬å‹™å¤–ã®ã‚±ãƒ¼ã‚¹ãŒå‰Šé™¤ã•ã‚Œã¦ã„ã‚‹ã‹
- [ ] ã‚³ãƒ¡ãƒ³ãƒˆã¯å¿…è¦ååˆ†ã‹
- [ ] ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯æ„å‘³ã®ã‚ã‚‹å€¤ã‹ï¼ˆ`foo`, `bar` ãªã©é¿ã‘ã‚‹ï¼‰
- [ ] ãƒ¬ã‚¤ãƒ¤ãƒ¼é–“ã§é‡è¤‡ã—ãŸãƒ†ã‚¹ãƒˆãŒãªã„ã‹

### ãƒªãƒªãƒ¼ã‚¹å‰ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ã¦ã„ã‚‹ã‹
- [ ] ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèªã—ãŸã‹
- [ ] E2E ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ã¦ã„ã‚‹ã‹
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã—ãŸã‹
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã—ãŸã‹ï¼ˆCodeGuardç­‰ï¼‰
- [ ] ã‚¯ãƒ­ã‚¹ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã—ãŸã‹ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºç­–

#### å•é¡Œ1: ãƒ†ã‚¹ãƒˆãŒä¸å®‰å®šï¼ˆãƒ•ãƒ¬ãƒ¼ã‚­ãƒ¼ï¼‰

**ç—‡çŠ¶:**
- åŒã˜ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ãŸã‚Šå¤±æ•—ã—ãŸã‚Šã™ã‚‹
- CI/CD ã§ã¯å¤±æ•—ã™ã‚‹ãŒãƒ­ãƒ¼ã‚«ãƒ«ã§ã¯æˆåŠŸã™ã‚‹

**åŸå› ã¨è§£æ±ºç­–:**
```typescript
// âŒ åŸå› : ã‚¿ã‚¤ãƒŸãƒ³ã‚°ä¾å­˜
it('should update UI', async () => {
  clickButton()
  expect(getDisplayText()).toBe('Updated') // éåŒæœŸå‡¦ç†ãŒå®Œäº†ã™ã‚‹å‰ã«æ¤œè¨¼
})

// âœ… è§£æ±ºç­–: éåŒæœŸå‡¦ç†ã®å®Œäº†ã‚’å¾…ã¤
it('should update UI', async () => {
  await clickButton()
  await waitFor(() => {
    expect(getDisplayText()).toBe('Updated')
  })
})

// âŒ åŸå› : ç¾åœ¨æ™‚åˆ»ã«ä¾å­˜
it('should check expiry', () => {
  const item = { expiryDate: new Date() }
  expect(isExpired(item)).toBe(true) // å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§çµæœãŒå¤‰ã‚ã‚‹
})

// âœ… è§£æ±ºç­–: æ™‚åˆ»ã‚’å›ºå®š
it('should check expiry', () => {
  const now = new Date('2024-01-01')
  const item = { expiryDate: new Date('2023-12-31') }
  expect(isExpired(item, now)).toBe(true)
})
```

#### å•é¡Œ2: ãƒ†ã‚¹ãƒˆãŒé…ã„

**ç—‡çŠ¶:**
- ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã«æ™‚é–“ãŒã‹ã‹ã‚‹
- CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒé…ã„

**åŸå› ã¨è§£æ±ºç­–:**
```typescript
// âŒ åŸå› : å®Ÿéš›ã®DBã‚’ä½¿ç”¨
beforeEach(async () => {
  await db.connect()
  await db.migrate()
})

// âœ… è§£æ±ºç­–: ã‚¤ãƒ³ãƒ¡ãƒ¢ãƒªDBã¾ãŸã¯ãƒ¢ãƒƒã‚¯ã‚’ä½¿ç”¨
beforeEach(() => {
  db = createInMemoryDatabase()
})

// âŒ åŸå› : ä¸å¿…è¦ãªå¾…æ©Ÿ
await page.waitForTimeout(5000) // 5ç§’å¾…ã¤

// âœ… è§£æ±ºç­–: æ¡ä»¶å¾…æ©Ÿ
await page.waitForSelector('.element', { timeout: 5000 })
```

#### å•é¡Œ3: ãƒ¢ãƒƒã‚¯ãŒæ©Ÿèƒ½ã—ãªã„

**ç—‡çŠ¶:**
- ãƒ¢ãƒƒã‚¯ã‚’è¨­å®šã—ãŸã®ã«å®Ÿéš›ã®é–¢æ•°ãŒå‘¼ã°ã‚Œã‚‹
- ãƒ†ã‚¹ãƒˆãŒå¤–éƒ¨ä¾å­˜ã«æ¥ç¶šã—ã‚ˆã†ã¨ã™ã‚‹

**åŸå› ã¨è§£æ±ºç­–:**
```typescript
// âŒ åŸå› : ãƒ¢ãƒƒã‚¯ã®è¨­å®šã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒé…ã„
import { fetchUser } from './api'
jest.mock('./api') // importã®å¾Œã§ã¯é…ã„

// âœ… è§£æ±ºç­–: importã®å‰ã«ãƒ¢ãƒƒã‚¯
jest.mock('./api')
import { fetchUser } from './api'

// ã¾ãŸã¯
beforeEach(() => {
  jest.clearAllMocks()
  jest.resetAllMocks()
})
```

#### å•é¡Œ4: ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒä¸ŠãŒã‚‰ãªã„

**ç—‡çŠ¶:**
- ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦ã‚‚ç‰¹å®šã®è¡ŒãŒã‚«ãƒãƒ¼ã•ã‚Œãªã„
- åˆ†å²ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒä½ã„

**åŸå› ã¨è§£æ±ºç­–:**
```typescript
// âŒ ã‚«ãƒãƒ¼ã•ã‚Œã¦ã„ãªã„åˆ†å²
function processValue(value: number | null): number {
  if (value === null) {
    return 0
  }
  return value * 2
}

// ãƒ†ã‚¹ãƒˆï¼ˆnull ã®å ´åˆãŒãƒ†ã‚¹ãƒˆã•ã‚Œã¦ã„ãªã„ï¼‰
it('should process value', () => {
  expect(processValue(5)).toBe(10)
})

// âœ… è§£æ±ºç­–: ã™ã¹ã¦ã®åˆ†å²ã‚’ãƒ†ã‚¹ãƒˆ
describe('processValue', () => {
  it('should process valid value', () => {
    expect(processValue(5)).toBe(10)
  })

  it('should return 0 for null', () => {
    expect(processValue(null)).toBe(0)
  })
})
```

### ãƒ‡ãƒãƒƒã‚°ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯

#### 1. console.log ãƒ‡ãƒãƒƒã‚°

```typescript
it('should calculate total', () => {
  const items = [100, 200]
  const result = calculateTotal(items)

  console.log('Items:', items)
  console.log('Result:', result)

  expect(result).toBe(300)
})
```

#### 2. ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã®ä½¿ç”¨

```typescript
it('should process data', () => {
  const data = prepareData()

  debugger // ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ‡ãƒãƒƒã‚¬ãƒ¼ãŒèµ·å‹•

  const result = processData(data)
  expect(result).toBeDefined()
})

// Node.js ã®å ´åˆ
// node --inspect-brk node_modules/.bin/jest --runInBand
```

#### 3. ãƒ†ã‚¹ãƒˆã®åˆ†é›¢å®Ÿè¡Œ

```bash
# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ
npm test -- --testNamePattern="should calculate total"

# ç‰¹å®šã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å®Ÿè¡Œ
npm test user.test.ts

# .only ã‚’ä½¿ç”¨ï¼ˆä¸€æ™‚çš„ï¼‰
it.only('should calculate total', () => {
  // ã“ã®ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œã•ã‚Œã‚‹
})
```

## ğŸ“Š ãƒ†ã‚¹ãƒˆãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®è¿½è·¡

### æ¨å¥¨ã™ã‚‹æ¸¬å®šé …ç›®

1. **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: 80%ä»¥ä¸Šã‚’ç¶­æŒ
2. **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“**: å˜ä½“ãƒ†ã‚¹ãƒˆã¯5åˆ†ä»¥å†…
3. **ãƒ†ã‚¹ãƒˆå¤±æ•—ç‡**: 5%ä»¥ä¸‹ã‚’ç›®æ¨™
4. **ãƒ•ãƒ¬ãƒ¼ã‚­ãƒ¼ãƒ†ã‚¹ãƒˆç‡**: 1%ä»¥ä¸‹ã‚’ç›®æ¨™
5. **ãƒ†ã‚¹ãƒˆæ•°ã®æ¨ç§»**: å¢—åŠ å‚¾å‘ã‚’ç¶­æŒ

### CI/CD ã§ã®ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

```yaml
# GitHub Actions ã®ä¾‹
name: Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Install dependencies
        run: npm ci

      - name: Run unit tests
        run: npm run test:unit -- --coverage

      - name: Run integration tests
        run: npm run test:integration

      - name: Run E2E tests
        run: npm run test:e2e

      - name: Upload coverage
        uses: codecov/codecov-action@v3
```

## ğŸ”— é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- **[SKILL.md](./SKILL.md)** - æ¦‚è¦ã«æˆ»ã‚‹
- **[TDD.md](./TDD.md)** - TDDã‚µã‚¤ã‚¯ãƒ«
- **[TEST-TYPES.md](./TEST-TYPES.md)** - ãƒ†ã‚¹ãƒˆã®ç¨®é¡
- **[TESTABLE-DESIGN.md](./TESTABLE-DESIGN.md)** - ãƒ†ã‚¹ã‚¿ãƒ–ãƒ«ãªè¨­è¨ˆ
