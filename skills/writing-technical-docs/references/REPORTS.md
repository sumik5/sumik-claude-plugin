# 報告書・レポートフォーマット

開発プロジェクトで使用する報告書のテンプレートとベストプラクティスを提供します。

## 📊 報告書の種類と使い分け

| 報告書種類 | 使用タイミング | 主な目的 |
|----------|--------------|---------|
| 実装完了報告 | 機能実装完了時 | 成果物の確認と品質保証 |
| 進捗報告 | 定期的（日次/週次） | プロジェクトの進行状況共有 |
| 技術調査レポート | 技術選定前 | 意思決定のための情報提供 |
| バグ報告 | バグ発見時 | 問題の特定と再現手順の共有 |
| リファクタリング報告 | リファクタリング完了時 | 変更内容と改善効果の記録 |

---

## 1. 実装完了報告

### テンプレート

```markdown
## 完了報告

### 実装内容
[具体的な実装内容を簡潔に記述]

例:
ユーザー認証機能を実装しました。JWT認証方式を採用し、
トークンの有効期限は24時間に設定しています。

### 成果物
- `src/auth/auth.service.ts`: 認証ロジックの実装
- `src/auth/auth.controller.ts`: 認証APIエンドポイント
- `src/auth/auth.guard.ts`: 認証ガード
- `src/auth/__tests__/auth.service.test.ts`: 単体テスト

### 品質チェック
- [x] SOLID原則遵守
- [x] 型安全性確保（any/Any型なし）
- [x] テストカバレッジ100%
- [x] CodeGuardセキュリティチェック完了
- [x] ESLint/Prettierチェック通過

### 動作確認
- テストケース: 全20件パス
  - 正常系: 12件
  - 異常系: 8件
- 手動確認: ログイン・ログアウト・トークン更新の動作確認済み
- パフォーマンス: 認証処理 平均15ms

### 技術的な注意点
- JWTトークンは環境変数`JWT_SECRET`で署名
- リフレッシュトークンは7日間有効
- 並行ログインは最大5セッションまで

### 次のステップ
- [ ] ソーシャルログイン機能の実装
- [ ] 二要素認証の追加
```

### 記述のポイント

1. **実装内容**: 何を実装したか簡潔に
2. **成果物**: ファイル名と役割を明記
3. **品質チェック**: 必須項目をチェックリスト化
4. **動作確認**: 具体的な数値で示す
5. **技術的な注意点**: 重要な設計判断を記録
6. **次のステップ**: 残タスクや改善点を明記

---

## 2. 進捗報告

### 日次進捗報告テンプレート

```markdown
## 日次進捗報告 - YYYY/MM/DD

### 本日の実施内容
- [完了] ユーザー認証API実装（#123）
- [完了] 単体テスト作成（カバレッジ100%達成）
- [進行中] 認証ガードの実装（進捗60%）

### 完了タスク
| タスク | 見積時間 | 実績時間 | 備考 |
|-------|---------|---------|------|
| 認証API実装 | 4h | 3.5h | 予定より早く完了 |
| 単体テスト | 2h | 2h | - |

### 進行中のタスク
- 認証ガードの実装
  - 進捗: 60%
  - 残り時間: 2h（予定）
  - ブロッカー: なし

### 明日の予定
- [ ] 認証ガードの完了
- [ ] 統合テストの作成
- [ ] ドキュメント更新

### 課題・相談事項
なし
```

### 週次進捗報告テンプレート

```markdown
## 週次進捗報告 - YYYY/MM/DD - YYYY/MM/DD

### サマリー
- 計画タスク: 10件
- 完了タスク: 8件（80%）
- 進行中: 2件
- ブロック中: 0件

### 主な成果
1. ユーザー認証機能の完成
   - JWT認証実装
   - テストカバレッジ100%
   - セキュリティチェック完了

2. 管理画面の基本実装
   - ユーザー一覧表示
   - CRUD操作実装

### 次週の計画
- [ ] ソーシャルログイン実装（見積: 8h）
- [ ] 権限管理機能実装（見積: 12h）
- [ ] パフォーマンス最適化（見積: 4h）

### リスクと対策
| リスク | 影響度 | 対策 |
|-------|-------|------|
| 外部API変更 | 中 | 抽象化層の実装 |

### メトリクス
- コードレビュー: 平均 1.5時間/PR
- テストカバレッジ: 95%
- ビルド時間: 3分
```

---

## 3. 技術調査レポート

### テンプレート

```markdown
## 技術調査レポート

### 調査目的
Next.js 14へのアップグレード可否を判断するため、
破壊的変更と移行コストを調査する。

### 調査対象
- Next.js 13.5.0（現行）
- Next.js 14.0.0（最新）

### 調査期間
2024/01/10 - 2024/01/12（3日間）

### 主な発見事項

#### 1. 破壊的変更
| 項目 | 変更内容 | 影響度 | 対応コスト |
|------|---------|-------|----------|
| App Router | デフォルト化 | 高 | 20h |
| 画像最適化 | 新しいAPI | 中 | 4h |
| フォント読み込み | 変更あり | 低 | 2h |

#### 2. 新機能とメリット
- Server Actions: フォーム処理が簡潔に（開発効率30%向上）
- Turbopack: ビルド時間が50%短縮（3分→1.5分）
- 部分レンダリング: 初回ロード時間が20%改善

#### 3. デメリット・リスク
- 学習コスト: チーム全体で約40時間
- サードパーティライブラリの互換性: 一部ライブラリが未対応
- ドキュメント: 一部が不完全

### 比較結果

| 評価項目 | Next.js 13 | Next.js 14 | 備考 |
|---------|-----------|-----------|------|
| パフォーマンス | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ビルド時間50%短縮 |
| 開発体験 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | Server Actions便利 |
| 安定性 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 一部バグ報告あり |
| エコシステム | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | 移行期間中 |

### 推奨事項

**結論: アップグレードを推奨**

**理由**:
1. パフォーマンス向上のメリットが大きい
2. 移行コストは許容範囲内（約26時間）
3. 長期的なメンテナンス性の向上

**実施計画**:
1. Phase 1（1週間）: 開発環境でのテスト
2. Phase 2（1週間）: ステージング環境への適用
3. Phase 3（3日）: 本番環境へのデプロイ

**リスク軽減策**:
- ロールバック手順の準備
- 段階的な移行（App Routerは並行運用）
- 十分なテスト期間の確保

### 参考資料
- [Next.js 14 リリースノート](https://nextjs.org/blog/next-14)
- [マイグレーションガイド](https://nextjs.org/docs/app/building-your-application/upgrading)
- [コミュニティの移行事例](https://github.com/vercel/next.js/discussions/...)
```

---

## 4. バグ報告

### テンプレート

```markdown
## バグ報告

### 概要
ログイン後、ダッシュボードページで500エラーが発生する

### 環境
- ブラウザ: Chrome 120.0.0
- OS: macOS 14.2
- アプリバージョン: v1.2.3
- 環境: ステージング

### 再現手順
1. ログインページにアクセス
2. 有効な認証情報でログイン
3. ダッシュボードページにリダイレクトされる
4. 500エラーページが表示される

### 期待される動作
ダッシュボードページが正常に表示される

### 実際の動作
500エラーページが表示される

### エラーログ
```
TypeError: Cannot read property 'name' of undefined
  at Dashboard.tsx:45
  at renderWithHooks (react-dom.js:1234)
```

### スクリーンショット
![エラー画面](./screenshots/error-500.png)

### 影響範囲
- 影響度: 高（全ユーザーに影響）
- 頻度: 100%（常に発生）
- 回避策: なし

### 原因分析
ユーザーデータ取得時、`user.profile`がnullの場合に
適切なエラーハンドリングが実装されていない。

### 修正案
Optional Chainingとデフォルト値の設定:
```typescript
const userName = user?.profile?.name ?? 'ゲスト'
```

### 関連Issue
- #456: ユーザープロフィール実装
```

---

## 5. リファクタリング報告

### テンプレート

```markdown
## リファクタリング報告

### 対象
認証関連のサービスクラス

### 目的
- コードの可読性向上
- SOLID原則の適用
- テスタビリティの改善

### 変更内容

#### Before
```typescript
class AuthService {
  login(email, password) {
    // 認証、トークン生成、DB保存を全て実施
    // 200行の巨大メソッド
  }
}
```

#### After
```typescript
class AuthService {
  constructor(
    private tokenService: TokenService,
    private userRepository: UserRepository
  ) {}

  async login(credentials: Credentials): Promise<AuthResult> {
    const user = await this.validateCredentials(credentials)
    const token = this.tokenService.generate(user)
    await this.userRepository.saveToken(user.id, token)
    return { user, token }
  }
}
```

### 改善効果

| 項目 | Before | After | 改善率 |
|------|--------|-------|-------|
| メソッドの平均行数 | 80行 | 15行 | 81%削減 |
| 循環的複雑度 | 25 | 8 | 68%削減 |
| テストカバレッジ | 45% | 100% | 122%向上 |
| 依存関係 | 8個 | 2個 | 75%削減 |

### 適用したパターン
- 依存性注入（DI）
- 単一責任の原則（SRP）
- 戦略パターン

### リスク
- なし（既存のテストがすべてパス）
- 後方互換性を維持

### 次のステップ
- [ ] 他のサービスクラスにも同様のリファクタリングを適用
- [ ] ドキュメント更新
```

---

## 📋 報告書作成のチェックリスト

### 共通項目
- [ ] タイトルは明確か
- [ ] 日付は記載されているか
- [ ] 7つのC原則を満たしているか
- [ ] 具体的な数値を使用しているか
- [ ] 技術用語は統一されているか

### 実装完了報告
- [ ] 実装内容は簡潔か
- [ ] 成果物リストは完全か
- [ ] 品質チェック項目はすべて確認済みか
- [ ] 動作確認結果は具体的か
- [ ] 次のステップは明確か

### 技術調査レポート
- [ ] 調査目的は明確か
- [ ] 比較基準は適切か
- [ ] 推奨事項には根拠があるか
- [ ] リスクと対策が記載されているか
- [ ] 参考資料は信頼できるか

### バグ報告
- [ ] 再現手順は明確か
- [ ] 環境情報は完全か
- [ ] エラーログは含まれているか
- [ ] 影響範囲は評価されているか
- [ ] 修正案は提示されているか

## 関連セクション

- [PRINCIPLES.md](PRINCIPLES.md): 7つのC原則の適用
- [STRUCTURE.md](STRUCTURE.md): 報告書の構造化
- [ANTI-PATTERNS.md](ANTI-PATTERNS.md): よくある誤り
