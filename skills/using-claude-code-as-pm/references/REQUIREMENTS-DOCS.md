# 要件定義・ペルソナ・ドキュメント

Claude Codeを使ったペルソナ生成、ユーザーストーリー作成、PRD作成・維持のワークフロー。

---

## ペルソナ生成ワークフロー

### 入力データの準備

以下のリサーチデータを `research/persona-development/` に配置:

```
research/persona-development/
├── interviews-enterprise-users.txt    # インタビュー書起こし
├── analytics-summary.md               # 行動分析データ
├── support-ticket-themes.md           # サポートチケットのテーマ
├── sales-notes.txt                    # 営業メモ
└── existing-personas-critique.md      # 既存ペルソナの課題点（あれば）
```

### ステップ1: ペルソナ分析（plan mode）

```
claude --permission-mode plan
```

プロンプト:
```
research/persona-development/ のリサーチ資料をレビューし、以下の観点でユーザータイプを特定:

- 目標と動機: 何を達成しようとしているか？
- 行動パターン: プロダクトや類似ツールをどう使うか？
- ペインポイント: 何に不満を感じ、何がブロッカーか？
- コンテキスト: 企業規模、役割、技術スキル、決裁権

データから何種類のペルソナが浮かび上がるか？各ペルソナについて:
- 定義特性（2-3の主要特徴）
- セグメント規模の推定（ユーザー全体の割合）
- 根拠となるエビデンス（出典を引用）

3-5のペルソナを推奨してください。
```

### ステップ2: ペルソナドキュメント生成

分析結果を確認後、ファイル生成モードで:

```
分析結果に基づき、docs/personas/ にペルソナドキュメントを作成。
1ペルソナ = 1ファイル: [persona-name].md

各ペルソナの構成:

1. 概要
   - 名前と役割（架空だが代表的な）
   - 1文サマリー
   - 写真プレースホルダ（説明テキストのみ）

2. デモグラフィクス
   - 役職
   - 企業規模
   - 業界（該当する場合）
   - 技術スキルレベル
   - 決裁権（購入者、影響者、エンドユーザー）

3. 目標と動機
   - 主要目標
   - 成功基準
   - 行動の動機

4. ペインポイントと不満
   - 現在の課題（プロダクト利用前）
   - 既存ソリューションへの不満
   - ワークフローのブロッカー

5. 行動と嗜好
   - 働き方（ワークフロー、ツール、プロセス）
   - プロダクト使用パターン
   - コミュニケーション嗜好
   - 意思決定アプローチ

6. プロダクトへのニーズ
   - Must-have機能（Deal-breaker）
   - 重要な機能（高価値）
   - Nice-to-have（低優先度）

7. 反対意見と懸念
   - 導入を躊躇させる要因
   - 評価時に出る質問
   - 解約原因になりうること

8. 裏付けエビデンス
   - リサーチからの代表的引用（2-3件）
   - ペルソナを裏付けるデータポイント

各ペルソナは2ページ以内。デモグラフィクスの詳細よりアクション可能なインサイトに集中。
```

---

## ユーザーストーリー生成

### コードベース参照型ストーリー生成

```
[機能名] のユーザーストーリーを docs/user-stories/[feature-name].md に生成。

各ストーリーに含める:
- ユーザーストーリー（As a... I want... So that...）
- 受入基準（Given/When/Then 形式）
- エッジケースとエラー状態
- 他機能への依存関係

コードベースを参照して技術的制約を反映してください。
```

### ストーリーの要点
- コードベースの既存パターンを参照することで、実装の現実性を反映
- 受入基準はGiven/When/Then形式で検証可能に
- エッジケースはClaude Codeのコード調査から発見可能

---

## PRD（Product Requirements Document）

### PRD作成プロンプト

```
[機能名] のPRDを docs/prds/[feature-name].md に作成。

含めるべきセクション:
- 問題定義（エビデンスを含む）
- 成功指標（測定可能なKPI）
- ユーザーストーリー + 受入基準
- スコープ（In/Out を明確に）
- 技術的考慮事項
- 依存関係
- オープンクエスチョン

コードベースの既存実装パターンを参照してください。
```

### PRD監査プロンプト

```
[PRDファイル] の完全性をレビュー:

- 明確な問題定義とエビデンスがあるか
- 測定可能な成功指標が定義されているか
- 受入基準付きのユーザーストーリーがあるか
- スコープ境界が明示されているか
- 技術的考慮事項が対処されているか
- 依存関係が特定されているか
- オープンクエスチョンがリストされているか

ギャップを指摘し、改善案を提案。
```

### ドキュメントと実装の同期

```
docs/ のドキュメントと現在のコードベースを比較:

- 古くなった情報
- 実装済みだがドキュメント未作成の機能
- 誤った例やコードスニペット
- 壊れた内部参照
```

---

## リリースノート

### チェンジログ生成

```
[前バージョンタグ] 以降のgitコミットをレビューし、
バージョン [X.Y.Z] のチェンジログエントリを生成。

外部ユーザー向けフォーマット: 実装詳細ではなくベネフィットに集中。
グループ: 新機能、改善、バグ修正
```

### リリースノートの要点
- エンジニア向け（何を変えたか）ではなく、ユーザー向け（何が良くなったか）
- 技術的な変更は「ユーザーへの影響」に変換
- コードベースのgit履歴から自動生成可能

---

## ドキュメント管理のベストプラクティス

| 原則 | 説明 |
|------|------|
| **リポジトリ内管理** | docs/ にMarkdownとして保存。バージョン管理される |
| **CLAUDE.mdとの統合** | よく参照する情報はCLAUDE.mdに含め、毎セッション自動読込 |
| **ペルソナの生きたドキュメント化** | 四半期ごとに新リサーチで更新、git diffで変遷追跡 |
| **PRDと実装の同期** | 実装変更時にPRDも更新。乖離は `/documentation-audit` で検出 |
| **成果物の命名規則** | 日付接尾辞 (`-2026-01.md`) で時系列管理 |
