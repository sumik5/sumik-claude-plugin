# SDN セキュリティ：倫理・脅威対応・データプレーン・マルチドメイン協調

## Ch9: 倫理的 AI エージェント

### コア倫理原則（ネットワーキング文脈）

| 原則 | 内容 |
|------|------|
| **Fairness（公平性）** | トラフィックや地域による差別的優先付けを排除 |
| **Transparency（透明性）** | AI 判断の解釈可能性を確保し、説明責任を果たす |
| **Privacy（プライバシー）** | データ匿名化・暗号化を通じてネットワーク情報を保護 |
| **Accountability（説明責任）** | AI 判断の結果に対する責任経路を明確化 |
| **Safety & Security（安全性）** | 意図しない障害・脆弱性の導入を防止 |

### 倫理的課題

- **アルゴリズムバイアス**: 学習データの偏りが不公平な QoS 判断を生む
- **不透明な意思決定**: ブラックボックス化した AI が監査・トラブルシュートを困難にする
- **プライバシー侵害リスク**: 高粒度トラフィック分析が監視に転用される可能性
- **自律性と人間監視の均衡**: 完全自律エージェントは責任帰属を曖昧にする
- **AI 自体の脆弱性**: 対抗的サンプルや汚染攻撃による誤検知・誤制御

### 主要倫理フレームワーク

| フレームワーク | 特徴 |
|---------------|------|
| **IEEE EAD（Ethically Aligned Design）** | 人間の幸福を中心とした AI 設計原則 |
| **EU AI Act** | リスクベースの規制、高リスク AI への厳格要件 |
| **NIST AI RMF** | ガバナンス・マッピング・計測・管理の4機能 |
| **ISO/IEC 42001** | AI マネジメントシステムの国際標準 |

### ガバナンスモデルとコンプライアンス

- **集中型ガバナンス**: 統一ポリシーの適用が容易だが単一障害点のリスク
- **分散型ガバナンス**: 各ドメインの自律性を尊重するが整合性確保が課題
- **ハイブリッド型**: 方針は集中、実行は分散（実務での推奨形態）
- **規制遵守**: GDPR・CCPA によるデータ保護、AI 固有の新興法制への対応
- **継続的監査**: 倫理監査・認証・コンプライアンス継続監視を組み合わせる
- **サポート技術**: Explainable AI ツール、自動コンプライアンスチェック、監査証跡

---

## Ch10: 脅威インテリジェンスとインシデントレスポンス

### 脅威インテリジェンスの種類

| 種別 | 対象 | 活用場面 |
|------|------|---------|
| **Strategic** | 脅威アクターの動機・能力・目標 | 経営判断・長期投資戦略 |
| **Tactical** | 攻撃者の TTP（戦術・技術・手順） | 検知ルール・シグネチャ開発 |
| **Operational** | 進行中のキャンペーン・標的情報 | 即時インシデント対応 |
| **Technical** | IOC（侵害指標）・マルウェアハッシュ | セキュリティツール自動化 |

### AI 検知技術マトリクス

| AI 技術 | 手法 | ネットワーク活用例 |
|---------|------|------------------|
| **ML 異常検知** | 教師あり（SVM・Random Forest）、教師なし（k-means・Autoencoder） | 既知マルウェア分類、ゼロデイ検知 |
| **DL パターン認識** | CNN（ペイロード解析）、RNN/LSTM（時系列イベント） | APT・多段階攻撃検知 |
| **NLP 脅威分析** | セキュリティアドバイザリ解析、Dark Web モニタリング | 新興脅威の早期発見 |
| **RL 適応防御** | フィードバックベースのポリシー最適化 | 動的ファイアウォールルール調整 |

### インシデントレスポンス戦略

1. **自動化対応**: 侵害エンドポイントの隔離、悪意ある IP ブロック、フォレンジックデータ収集
2. **優先順位付け・トリアージ**: リスクスコアリング、アラートの相関グルーピング、優先キュー管理
3. **根本原因分析**: イベントシーケンス再構成、攻撃経路可視化、パッチ・設定変更への反映
4. **ポストインシデント学習**: インシデントデータでのモデル再学習、教訓の脅威インテリジェンスへの反映

### 連合学習によるプライバシー保護コラボレーション

```
[組織A] ローカルモデル学習 ──→ 勾配更新
[組織B] ローカルモデル学習 ──→ 勾配更新  → 集中集約 → グローバルモデル
[組織C] ローカルモデル学習 ──→ 勾配更新
         ↑ 生データは外部に出ない
```

- **STIX**: 脅威情報の標準表現形式
- **TAXII**: 脅威インテリジェンス交換プロトコル

### 証明書・鍵管理の AI 化

| 課題 | AI ソリューション |
|------|----------------|
| 有効期限切れリスク | ML による予測更新スケジューリング |
| 侵害・失効管理 | 使用パターン異常検知→自動アラート |
| 大規模インベントリ | ネットワーク全体の自動探索・台帳作成 |
| ポリシー準拠 | 鍵長・アルゴリズムの自動検証 |

---

## Ch16: プログラマブルデータプレーンセキュリティ

### セキュリティ課題

| 課題領域 | 具体的リスク |
|---------|-------------|
| **拡大する攻撃面** | P4 プログラムのバグ・バックドア、不正コード注入、制御インターフェース悪用 |
| **内部脅威** | 権限ある人員による悪意ある論理挿入、設定ミス |
| **リアルタイム検知の困難** | ライン速度処理、テレメトリ過負荷、誤検知と遅延のトレードオフ |
| **鍵管理の複雑性** | 動的な鍵配布、ローテーション、多様なハードウェア対応 |

### AI 技術マッピング

| AI 技術 | データプレーンへの適用 |
|--------|----------------------|
| **ML 異常検知** | パケットヘッダー・フロー統計の空間的/時間的相関分析、DDoS・スプーフィング検知 |
| **DL 侵入検知** | RNN（フロー時系列）、CNN（トラフィック行列）による APT 検知 |
| **RL 自動応答** | フィルタリング・再ルーティング・隔離の最適ポリシー学習 |
| **Explainable AI（XAI）** | 特徴量帰属、可視化、ルール抽出による透明性確保 |
| **GNN** | 攻撃伝播モデリング、横方向移動検知、アクセス制御グラフ検証 |

### SmartNICs と協調 AI フレームワーク

**SmartNICs の利点**:
- ライン速度でのオンデバイス脅威検知・緩和
- 外部コントローラへのオフロード不要→低レイテンシ
- 専用ハードウェアによる AI 推論の省電力化

**協調 AI フレームワーク**:
- **Federated Learning**: 生データ共有なしのグローバルモデル学習
- **協調防御**: エージェント間の異常相関によるネットワーク全体対応
- **IoC リアルタイム共有**: 侵害指標の即時共有による検知精度向上

**適応型セキュリティポリシー**:
- ネットワークコンテキスト（トラフィックパターン、トポロジー変化）に応じた動的調整
- Homomorphic Encryption・Differential Privacy による分析時プライバシー保護

### 証明書・鍵ライフサイクル管理の AI 化

```
[AI 予測分析]
  脅威インテリジェンス × 使用パターン → 最適ローテーション間隔を予測

[異常検知]
  通常とは異なる証明書使用 → 侵害の可能性を即時アラート

[ワークフロー自動化]
  発行 → 更新 → 失効 のライフサイクルを最小人手で実行

[リスクベース認証]
  行動分析でデバイス・証明書の信頼度を動的評価
```

---

## Ch19: マルチドメイン SDN の協調セキュリティ

### マルチドメインの課題

| 課題 | 説明 | セキュリティへの影響 |
|------|------|---------------------|
| **管理境界の多様性** | ドメインごとに異なるポリシー・ガバナンス | 統一的な脅威検知・対応を阻害 |
| **攻撃面の拡大** | ドメイン間接続が横方向移動・多段階攻撃を可能に | 侵害リスクの指数的増大 |
| **可視性の制限** | プライバシー・競合懸念による共有拒否 | 状況認識・早期警戒の低下 |
| **技術的異質性** | 多様なコントローラ・デバイス・プロトコル | 相互運用性・ポリシー一貫性の欠如 |
| **リアルタイム対応の必要性** | 速攻の脅威への即時協調対応 | 手動プロセスでは対応不可 |

### AI 協調アプローチ

| アプローチ | 技術 | 効果 |
|-----------|------|------|
| **脅威情報共有** | Federated Learning による生データ非共有学習 | プライバシー保護しながら検知精度向上 |
| **分散異常検知** | マルチドメインデータセットで学習した協調 ML | 横方向移動・ゼロデイ攻撃の早期検知 |
| **自動インシデント対応** | RL エージェントによるクロスドメイン動的応答 | 対応時間短縮・人的ミス低減 |
| **動的トラスト管理** | 行動分析・履歴ベースのアクセス制御 | セキュリティとアジリティの両立 |

### ブロックチェーン + AI のセキュア協調

```
[各ドメインローカル AI]
  ├─ 脅威検知・ローカル対応
  └─ ブロックチェーンへイベント記録（改ざん防止）
        ↓
[協調 AI レイヤー]
  ├─ ブロックチェーン記録の AI 分析（ポリシー違反検出）
  ├─ 集約脅威インテリジェンス
  └─ クロスドメイン対応オーケストレーション
```

### ケーススタディ

**協調 DDoS 緩和（ISP コンソーシアム）**:
- 各ドメインの AI モジュールが異常アラートを共有
- ML 分類器が攻撃シグネチャを特定しトラフィックフィルタリングルールを協調適用
- 単独防御対比で攻撃トラフィック量を約 40% 削減

**クロスドメイン侵入検知（Federated Learning）**:
- 複数企業がセキュリティログ非共有で共有侵入検知モデルを学習
- 新規・ゼロデイ脅威の検知率を 25% 改善、データプライバシー完全維持

**AI オーケストレーション対応（スマートシティ SDN）**:
- RL エージェントがファイアウォールポリシー動的調整・トラフィック再ルーティング・影響セグメント隔離を実行
- インシデント解決時間を 35% 短縮

**ブロックチェーンバック型ポリシー管理（金融機関）**:
- SDN ドメイン間のポリシー変更を改ざん防止台帳に記録
- AI がコンプライアンス違反・不審アクティビティをリアルタイム監視

---

## 脅威モデルと防御策の対応

| 脅威カテゴリ | 攻撃例 | AI 防御策 |
|-------------|--------|----------|
| **コード注入** | 悪意ある P4 プログラム挿入 | 継続的コード検証、挙動ベース異常検知 |
| **DDoS** | ボリューム型攻撃、反射増幅 | ML フロー分析、協調フィルタリング |
| **APT・多段階攻撃** | 潜伏型侵害、横方向移動 | RNN 時系列分析、GNN 伝播モデリング |
| **証明書・鍵侵害** | 中間者攻撃、鍵盗用 | 使用パターン異常検知、自動失効 |
| **インサイダー脅威** | 権限悪用、設定ミス誘発 | 行動分析、Explainable AI による監査 |
| **クロスドメイン攻撃** | ドメイン境界を越えた侵害伝播 | 連合学習、分散異常検知、動的トラスト |
| **サプライチェーン** | ファームウェア汚染 | コード完全性検証、AI 供給元評価 |
