# フォーム・入力ルール

> フォームはユーザーとシステムの対話の要。入力の容易さとバリデーションの適切さが完了率を決める。

## クイックリファレンス

| # | ルール | Do | Don't |
|---|-------|----|----|
| 036 | 検索はシンプルなテキストフィールドと検索ボタンの形式に | テキストフィールド+虫眼鏡アイコンの検索ボタン | 検索フィールド表示用アイコンのみ |
| 037 | 複数行になりそうな入力欄は状況に合わせてサイズを調節せよ | 典型的な回答量に応じたサイズ設定 | 全入力欄を一律のサイズに |
| 038 | フォーム入力は極力容易にせよ | メアド+パスワードのみで登録可能に | 不要な個人情報を大量に要求 |
| 039 | フォームへの入力データは極力その場で検証せよ | 入力欄を離れた瞬間にエラー表示 | 送信後にエラー一覧を表示 |
| 040 | フォームを検証したら要修正箇所を明示せよ | エラー箇所をハイライト+修正提案 | 「入力エラーがありました」のみ |
| 041 | ユーザーの入力データの形式に関しては「太っ腹」で | スペース/記号の有無を柔軟に受付 | 特定の書式を強制 |
| 042 | 郵便番号や住所の入力を容易に | 郵便番号入力で住所自動補完 | 厳密な書式検証を事前に強制 |
| 043 | 電話番号の書式は柔軟に | `<input type="tel">` でテンキー表示 | UIで厳密な書式検証 |
| 044 | メールアドレスの細かな検証は不要 | `<input type="email">` + サーバー側検証 | クライアント側でTLD等を厳密検証 |
| 045 | 注文と支払いのページは極力使いやすくせよ | 簡潔な価格設定+ワンタップ購入 | 複雑な注文フォーム+不明瞭な料金プラン |
| 046 | 決済時の情報入力は必要最低限に絞れ | カード番号/有効期限/CVVのみ | 発行番号/開始日/自宅電話等も要求 |
| 047 | 金額入力欄における小数点以下の位の自動追加はやめろ | ユーザーが小数点以下を任意入力 | 自動的に「.00」を追加 |
| 048 | 画像の追加を容易に | システム標準の画像選択機能を活用 | 独自の複雑な画像アップロード機能 |
| 049 | ユーザーが入力したデータは指示されない限り絶対に消すな | フォーム再表示時も入力内容を保持 | ページ再表示で入力内容をリセット |
| 050 | ユーザーが使おうとしている最中に動いてしまうUIなんて最悪だ | 静的なUI+短時間のマイクロアニメーション | 広告読込でコンテンツが移動 |
| 051 | パスワードは「*」に置き換えるべきだが、「パスワードを表示」のボタンも用意せよ | 「*」表示+「表示」トグルボタン | パスワードを常に「*」で隠す |
| 052 | パスワード入力欄はペースト可能にせよ | パスワードマネージャーのペースト許可 | JavaScriptでペーストを無効化 |
| 053 | 「パスワードをお忘れですか？」のページでは最初から入力欄にユーザー名を表示せよ | ログイン失敗時のユーザー名を再利用 | ユーザー名の再入力を要求 |
| 054 | パスワードの再設定ページに関する留意点 | 「パスワードをお忘れの方」+長いセッション | 「リセット用のリンクを受け取る」+短いセッション |
| 055 | 破壊的アクションは取り消し可能に | トースト通知+UNDO ボタン | 確認ダイアログのみ |

---

## 詳細ルール

### 036: 検索はシンプルなテキストフィールドと検索ボタンの形式に

- **核心**: 検索フィールドを常時表示し、虫眼鏡アイコンのボタンを用意する
- **理由**: アイコンのみの表示は省スペースだが、検索手順が1ステップ増えてユーザーが慣れた方法を使えなくなる
- **実装指針**:
  - テキストフィールド + 虫眼鏡アイコンの検索ボタンを標準とする
  - モバイルでは最上部に配置するか、リストビュー最上部に隠しスクロールで表示
  - モバイルアプリでは検索タブタップ時に検索フィールドにフォーカス+キーボード自動表示

### 037: 複数行になりそうな入力欄は状況に合わせてサイズを調節せよ

- **核心**: テキストエリアのサイズは典型的な回答の長さに応じて個別に設定する
- **理由**: 広すぎると画面スクロールが必要になり、狭すぎると枠内スクロールが必要になる
- **実装指針**:
  - 各入力欄で想定される回答量を事前に検討し、それに応じたサイズを設定
  - 全入力欄を一律のサイズにしない
  - デザイン初期段階でユースケースごとに調整

### 038: フォーム入力は極力容易にせよ

- **核心**: 登録に必要な情報を最小限（メアド+パスワード）に絞る
- **理由**: 入力項目が増えるほどユーザーは離脱し、コンバージョン率が下がる
- **実装指針**:
  - 理想: メールアドレス or 携帯電話番号 + パスワード（1回のみ入力）のみ
  - 許容: 氏名（オプション）、郵便番号・住所（配送時のみ）
  - 不要な情報を要求する場合は理由と用途を明示
  - 既にシステムが保持している情報は要求しない

### 039: フォームへの入力データは極力その場で検証せよ

- **核心**: ユーザーが次の入力欄へ移動した瞬間にクライアント側で検証する
- **理由**: 送信後のサーバー往復は時間がかかり、ユーザーは入力経緯を思い出す必要がある
- **実装指針**:
  - クライアント側での検証ライブラリを活用
  - エラー箇所を送信前に表示し、修正方法も提示
  - 日付ピッカー等では論理的制約（チェックアウト > チェックイン）を事前に組み込む
  - 入力ミスがあっても既存データは削除しない

### 040: フォームを検証したら要修正箇所を明示せよ

- **核心**: サーバー側検証で引っかかった場合、エラー箇所をハイライト+修正提案を表示
- **理由**: ユーザーは複数データを入力しており、時間が経過しているため、エラー箇所を探すのは困難
- **実装指針**:
  - 要修正箇所をハイライト表示
  - よくあるエラー（`gmail.con` → `gmail.com`）は自動修正を提案
  - 「入力エラーがありました」のような漠然としたメッセージは避ける
  - ユーザーに間違い探しをさせない

### 041: ユーザーの入力データの形式に関しては「太っ腹」で

- **核心**: 入力データの書式にバリエーションを許容し、システム側で正規化する
- **理由**: ユーザーの入力方法は多様であり、開発者の都合で制限すべきではない
- **実装指針**:
  - アクセント付き文字（é）、特殊記号（'、-）を許容
  - 電話番号は「-」やスペース、内線番号の有無を柔軟に受け入れる
  - クレジットカード番号はスペースの有無を問わない
  - 郵便番号は「-」やスペースを含んでも処理できるようにする
  - 技術的難題を引き受けてでもユーザーの負担を軽減

| 項目 | 許容すべき例 |
|------|------------|
| 名前 | 姓+複数の名、「-」「'」を含む名前 |
| 電話番号 | 「-」区切り、スペース区切り、内線番号付き |
| 郵便番号 | 「-」有無、スペース有無 |
| カード番号 | スペース有無、4桁ごと区切り |

### 042: 郵便番号や住所の入力を容易に

- **核心**: 郵便番号入力で住所候補を自動表示し、大部分の入力を省略できるようにする
- **理由**: キー操作とクリック回数を削減し、検証済みデータが入力されるためエラー率が下がる
- **実装指針**:
  - 郵便番号は国・地域によって異なるため、テキスト入力欄で柔軟に受け入れる
  - HTMLの`<input autocomplete="shipping postal-code">`を指定
  - 郵便番号から住所を自動補完する機能を実装
  - 国コード選択で入力済みデータを削除しない

### 043: 電話番号の書式は柔軟に

- **核心**: UIで電話番号の検証をせず、ユーザーには単に番号を入力してもらう
- **理由**: 国際的な電話番号の書式は多様であり、特定の書式を強制すると他国ユーザーが入力できない
- **実装指針**:
  - HTMLで`<input type="tel">`を使用し、モバイルでテンキーを表示
  - `autocomplete`属性を指定してタップ1回で入力完了
  - 検証はサーバー側で実施
  - スペース、括弧、ハイフンの有無を柔軟に受け入れる

### 044: メールアドレスの細かな検証は不要

- **核心**: クライアント側での厳密なメールアドレス検証を避け、ブラウザに任せる
- **理由**: TLDが1000種類以上あり、絵文字ドメイン等のエッジケースも存在するため、厳密検証はリスクが高い
- **実装指針**:
  - HTMLで`<input type="email">`と指定
  - `autocomplete`属性で自動入力を促す
  - サーバー側検証として、ワンクリックURLをメール送信
  - 有効なユーザーを誤ってブロックしない

### 045: 注文と支払いのページは極力使いやすくせよ

- **核心**: 価格設定、注文フォーム、支払いフローを簡素化し、定期的にテストする
- **理由**: ユーザーは製品を気に入って代金を払おうとしているため、手続きを極力容易にすべき
- **実装指針**:
  - 価格設定ページ: 特徴リストを簡潔に整理、購入ボタンに視覚的シグニファイアを付ける
  - 注文フォーム: 不要な情報は要求せず、数量変更等の裁量権をユーザーに委ねる
  - 支払いフォーム: 必要最低限の情報のみ収集
  - モバイルではアプリ内課金でワンタップ購入を実現
  - 支払いフローを定期的にテスト

| 要素 | 設計原則 |
|------|---------|
| 価格設定ページ | 簡潔明瞭、非表示にしない、一般的な価格構成 |
| 注文フォーム | 簡素、不要情報不要、ユーザーに裁量権 |
| 支払いフォーム | 必要最低限の情報、わかりやすい |

### 046: 決済時の情報入力は必要最低限に絞れ

- **核心**: クレジットカード情報は番号、有効期限、セキュリティコードのみに絞る
- **理由**: 入力欄が増えるほど離脱リスクが高まる
- **実装指針**:
  - 必須項目: カード番号、有効期限、セキュリティコード
  - 番号は単独の入力欄で、自動的に4桁ごとに区切って表示
  - ユーザーがスペースを入力したら自動削除
  - セキュリティコードの位置・名称を説明する補足テキストを表示
  - 発行番号、開始日、郵便番号は不要
  - HTTPSで必ず通信を保護（Let's Encrypt等を利用）

### 047: 金額入力欄における小数点以下の位の自動追加はやめろ

- **核心**: ユーザーが小数点以下を入力できるようにし、入力がなければ「.00」と解釈する
- **理由**: 自動追加は「$10」→「$1,000」のような深刻なエラーにつながる
- **実装指針**:
  - 小数点以下はユーザー自身がタイプ入力
  - 入力がなければ「.00」だと解釈
  - 入力金額を必ず表示して確認してもらう
  - 自動追加機能は使わない

### 048: 画像の追加を容易に

- **核心**: デバイス標準の画像選択機能を活用し、プレビューで切り取り・回転を可能にする
- **理由**: システム内蔵の画像選択機能はユーザーの好みに合った方法で選択できる
- **実装指針**:
  - ファイル選択・写真撮影の設定はユーザーに任せる
  - 複数画像の一括アップロードを可能にする
  - プレビュー画面で「切り取り」「回転」のコントロールを提供
  - JPEG、PNG、GIF等の各種ファイル形式を受け入れる
  - アップロード中の進捗状況を明示
  - Gravatar等の外部サービス利用も選択肢に

### 049: ユーザーが入力したデータは指示されない限り絶対に消すな

- **核心**: フォーム再表示時に入力データを保持し、ユーザーが明示的に放棄するまで削除しない
- **理由**: ユーザーが費やした時間と労力を尊重し、入力データの削除は最悪の体験
- **実装指針**:
  - ページ再表示時に入力データを事前に保存
  - ユーザーが「キャンセル」等で明示的に放棄するまで保持
  - 技術的な都合（白紙のフォーム取得）でもデータ削除は回避
  - ユーザーの身になって「これをもう一度入力したいか？」と自問

### 050: ユーザーが使おうとしている最中に動いてしまうUIなんて最悪だ

- **核心**: UI要素は常に静止させ、広告等の遅延読み込みでレイアウトが変動しないようにする
- **理由**: タップ・クリックの瞬間にUIが動くと、ユーザーは意図しない場所を操作してしまう
- **実装指針**:
  - テストで読み込み挙動を確認し、プレースホルダで遅延要素の場所を確保
  - 通知表示でコントロールが移動しないようにする
  - マイクロアニメーションは目立たず短時間（0.2〜0.3秒以内）で終わるようにする
  - さまざまなデバイス・通信速度でテスト
  - 広告等の遅延読み込みでコンテンツが移動しないように設計

### 051: パスワードは「*」に置き換えるべきだが、「パスワードを表示」のボタンも用意せよ

- **核心**: パスワードは「*」で隠すが、「パスワードを表示」トグルボタンを提供する
- **理由**: ユーザーは長く複雑なパスワードを安心して設定でき、入力ミスも減る
- **実装指針**:
  - デフォルトは「*」表示
  - 「パスワードを表示」ボタン or チェックボックスを追加
  - パスワードの強度ルールは入力フィールド表示中に常に明示
  - パスワードを二度入力させない（リセット機能で代替）

### 052: パスワード入力欄はペースト可能にせよ

- **核心**: パスワード入力欄へのペーストを無効化せず、パスワードマネージャーの利用を許可する
- **理由**: ペースト無効化は覚えやすく破られやすいパスワードの使用を強制し、セキュリティが低下する
- **実装指針**:
  - JavaScriptでペーストを無効化しない
  - コピー、ペースト、検索、右クリック等のシステムレベル機能は無効化しない
  - パスワードマネージャーのオートフィル機能を妨げない
  - 長く複雑なパスワードの利用を促進

### 053: 「パスワードをお忘れですか？」のページでは最初から入力欄にユーザー名を表示せよ

- **核心**: ログイン失敗後の「パスワードをお忘れですか？」ページにユーザー名を事前入力する
- **理由**: ユーザーは既にユーザー名を入力しているため、再入力は無駄な手間
- **実装指針**:
  - ログイン失敗時のユーザー名をパスワードリセットページに引き継ぐ
  - 「パスワードをお忘れですか？」ボタンを表示
  - パスワード再設定リンクをメール or SMS で送信（一定期間で無効化）
  - リンクは複数回クリックしても無効にならないようにする
  - パスワード変更完了後は自動サインイン

### 054: パスワードの再設定ページに関する留意点

- **核心**: 「パスワードをお忘れの方」という明確なラベルを使い、セッション期間を長めに設定する
- **理由**: 頻繁なサインインはユーザー体験を悪化させ、覚えやすいパスワードの使用を促してセキュリティが低下する
- **実装指針**:
  - ラベルは「パスワードをお忘れの方」（「リセット」「アクセスできませんか？」は避ける）
  - ユーザー名が登録済みなら入力欄に事前表示
  - パスワード再設定リンクの要件:
    - 一度クリックで失効しない（ダブルクリック対応）
    - 妥当な有効期限を設定
    - 再設定成功後に失効
  - セッション有効期間を長めに設定（エンタープライズ: 数時間〜1日、モバイル: 数週間〜数ヶ月）

| セッション戦略 | 影響 |
|--------------|------|
| 短いセッション | 頻繁なサインイン → 覚えやすいパスワード → セキュリティ低下 |
| 長いセッション | サインイン頻度低下 → 複雑なパスワード許容 → セキュリティ向上 |

### 055: 破壊的アクションは取り消し可能に

- **核心**: 削除、送信等の破壊的アクションの後にトースト通知+UNDOボタンを表示する
- **理由**: ユーザーのミスを救済し、主導権を握っている感覚を強める
- **実装指針**:
  - 操作後にバナー or トースト通知を表示
  - 「取消」ボタンを一定時間（5〜20秒）表示
  - Gmailの送信取消機能（送信後の猶予期間）を参考に
  - ユーザーが実験・冒険を試みやすくなり、生産性向上
  - 人間はヘマをするものという前提で寛大に設計

| 取消機能の実装例 | 効果 |
|----------------|------|
| メール送信取消 | 送信後5〜20秒のバッファで誤送信を防止 |
| レコード削除取消 | トースト通知+UNDOボタンで誤削除を復旧 |
| 数量変更取消 | 最終決定前の編集機能で誤操作を修正 |

---

## 実装チェックリスト

### 基本検証
- [ ] 入力欄のサイズは典型的な回答量に応じて設定されているか
- [ ] 不要な情報を要求していないか
- [ ] クライアント側でその場で検証を実施しているか
- [ ] エラー箇所を明示し、修正提案を表示しているか

### 入力の柔軟性
- [ ] 電話番号、郵便番号、カード番号等の書式を柔軟に受け入れているか
- [ ] スペース、ハイフン、記号の有無を問わず処理できるか
- [ ] 国際的なバリエーションに対応しているか

### ユーザビリティ
- [ ] 検索フィールドは常時表示されているか
- [ ] モバイルでテンキー等の適切なキーボードが表示されるか
- [ ] 住所自動補完、オートフィル等の便利機能を実装しているか
- [ ] UI要素が読み込み中に移動しないか

### セキュリティ
- [ ] パスワード入力欄へのペーストが可能か
- [ ] 「パスワードを表示」ボタンが提供されているか
- [ ] HTTPSで通信を保護しているか
- [ ] セッション有効期間は適切か

### データ保護
- [ ] ユーザーが入力したデータは明示的に指示されない限り保持されているか
- [ ] 破壊的アクションの取り消し機能が提供されているか
- [ ] パスワードリセット時にユーザー名が事前入力されているか

---

## よくある判断

| 状況 | 判断基準 |
|------|---------|
| 検索フィールドの配置 | モバイル: 最上部 or リストビュー最上部（スクロールで表示）、デスクトップ: 常時表示 |
| パスワードの二度入力 | 不要（リセット機能で代替） |
| メールアドレスの検証 | クライアント側は最小限（`<input type="email">`）、サーバー側でワンクリックURL送信 |
| セッション有効期間 | エンタープライズ: 数時間〜1日、モバイル: 数週間〜数ヶ月（短すぎる設定は避ける） |
| 金額の小数点以下 | ユーザーが入力、入力なしなら「.00」と解釈（自動追加は禁止） |
| 画像アップロード | デバイス標準機能を活用、複数画像一括アップロード、プレビューで編集 |
| 破壊的アクション | トースト通知+UNDOボタン（5〜20秒の猶予期間） |
